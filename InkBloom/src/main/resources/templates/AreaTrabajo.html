<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Área de Trabajo - InkBloom</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css">
  <link href="https://cdn.quilljs.com/1.3.7/quill.snow.css" rel="stylesheet">
</head>
<body class="bg-gray-100">
<div class="container mx-auto py-6">
  <h2 class="text-xl font-semibold mb-4">Editando: <span th:text="${documento.titulo}"></span></h2>

  <!-- Aquí se muestra el editor con el contenido del documento -->
  <div id="editor" th:data-documento="${documento.cuerpo}" class="bg-white p-4 rounded shadow-md"></div>

  <button class="bg-blue-500 text-white px-4 py-2 rounded mt-4 hover:bg-blue-600" onclick="guardarCambios()">Guardar Cambios</button>
</div>

<script src="https://cdn.quilljs.com/1.3.7/quill.min.js"></script>
<script>
  // Inicializa Quill
  const editor = new Quill('#editor', {
      theme: 'snow'
  });

  // Carga el contenido inicial desde el servidor
  const contenido = document.getElementById('editor').dataset.documento;
  editor.root.innerHTML = contenido;

  // Función para guardar los cambios
  async function guardarCambios() {
      const contenido = editor.root.innerHTML;
      await fetch('/documento/agregar', {
          method: 'POST',
          headers: {
              'Content-Type': 'application/json',
          },
          body: JSON.stringify({ texto: contenido }),
      });
      alert('Documento guardado!');
  }
</script>
</body>
</html>
